{% load static %}
<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>{{ noticia.titulo }} - JCPE</title>
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <link rel="icon" href="{% static 'img/logo_jcpe.png' %}">
</head>
<body>
    <header>
        <a href="{% url 'inicial' %}">
            <img src="{% static 'img/logo_jcpe.png' %}" alt="Logo JCPE" class="logo">
        </a>
        <h1>JCPE - Jornal do Commercio de Pernambuco</h1>
    </header>

    <main>
        <h1>{{ noticia.titulo }}</h1>
        <p>{{ noticia.materia }}</p>
        <small>
            Autor: {{ noticia.autor }} |
            Publicada em: {{ noticia.data_criacao|date:"d/m/Y H:i" }}
        </small>

        <hr>
        <h2>Respostas</h2>

        {% with comentarios_raiz=noticia.resposta_set.all|dictsort:"data_criacao" %}
            {% for comentario in comentarios_raiz %}
                {% if not comentario.pai %}
                    <div>
                        <p><b>{{ comentario.usuario }}</b>: {{ comentario.texto }}</p>
                        <small>{{ comentario.data_criacao|date:"d/m/Y H:i" }}</small>
                        <br>
                        <a href="{% url 'inserir_resposta' noticia.id %}?pai={{ comentario.id }}">Responder</a>

                        <!-- Exibir respostas-filho -->
                        {% for filho in comentario.comentarios_filho.all %}
                            <div style="margin-left: 30px;">
                                <p><b>{{ filho.usuario }}</b>: {{ filho.texto }}</p>
                                <small>{{ filho.data_criacao|date:"d/m/Y H:i" }}</small>
                            </div>
                        {% endfor %}
                    </div>
                {% endif %}
            {% empty %}
                <p>N√£o h√° respostas para esta not√≠cia.</p>
            {% endfor %}
        {% endwith %}

        <form action="{% url 'salvar_noticia' noticia.id %}" method="POST" style="text-align: center; margin-top: 20px;">
            {% csrf_token %}
            <button type="submit" class="button">‚≠ê Salvar not√≠cia</button>
        </form>


        <div class="links-centrais">
            <a href="{% url 'inserir_resposta' noticia.id %}" class="button">üí¨ Responder</a>
            <a href="{% url 'inicial' %}" class="button">‚¨Ö Voltar</a>
            <a href="{% url 'apagar_noticia' noticia.id %}" class="button excluir">üóë Apagar</a>
        </div>
    </main>

    <footer>
        &copy; 2025 JCPE - Todos os direitos reservados.
    </footer>
</body>
</html>
